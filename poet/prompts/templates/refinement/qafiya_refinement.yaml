name: qafiya_refinement_v2
description: "Analyzes and corrects qafiya (rhyme scheme) violations in an Arabic poetry verse while preserving its original meter and meaning."
template: |
  ### المهمة الأساسية
  بصفتك خبيرًا دقيقًا في القوافي العربية، مهمتك هي **إصلاح قافية بيت شعري** به خلل، مع **افتراض أن وزنه العروضي صحيح** والتركيز فقط على تحقيق القافية المطلوبة.

  ---

  ### 1. المعايير المستهدفة للإصلاح (الهدف)
  - **البحر الشعري (للسياق فقط):** {meter}
  - **القافية المطلوبة:** {qafiya}
  - **نمط القافية المطلوب:** {qafiya_pattern}
  - **نوع القافية المستهدف:** {qafiya_type}
  - **مرجع أنواع القوافي (إلزامي):** {qafiya_type_description_and_examples}
  - **موضوع الأبيات:** {theme}
  - **النبرة الشعرية:** {tone}

  ---

  ### 2. البيت المطلوب تحليله وإصلاحه (المشكلة)
  - **البيت الأصلي (الذي يحتوي على خلل في القافية):**
  {existing_verses}
  - **تحليل المشكلة:**
  {context}

  ---

  ### 3. منهجية الإصلاح الأساسية (القواعد الإلزامية)
  1.  **الهدف الأوحد: قافية صحيحة:** يجب أن يتطابق البيت المصحح تمامًا مع **نمط القافية المطلوب ({qafiya_pattern})** و**نوعها ({qafiya_type})**. هذا هو هدفك الأساسي.
  2.  **تجاهل الوزن العروضي:** **لا تحاول إصلاح الوزن إطلاقًا**. افترض أنه صحيح وركز تعديلاتك على نهاية البيت فقط.
  3.  **الحرية الإبداعية في الصياغة:** لديك الحرية الكاملة في **إعادة صياغة نهاية البيت** لتحقيق القافية الصحيحة. لا تلتزم بشكل الكلمة الأصلية أو جذرها. يمكنك اقتراح كلمات جديدة تمامًا (مثل استبدال "حُرَق" بـ "رفيق" أو "طريق") طالما أنها تخدم القافية والمعنى.
  4.  **الحفاظ على المعنى الجوهري:** بالرغم من حريتك في الصياغة، يجب أن تحافظ على الفكرة الأساسية والنبرة ({tone}) للبيت الأصلي. الهدف هو إيجاد التوازن المثالي بين القافية الصحيحة والمعنى المتسق.

  ---

  ### 4. قواعد التشكيل الدقيقة (التزام إجباري)
  - ضع سكون (ْ) على اللام في (الْـ).
  - لا تضع حركة على الحرف المشدد، بل الشدة فقط (مُحَمَّدٌ).
  - لا تضع أي حركة على حروف المد الساكنة (ا، و، ي، ى).
  - طبّق الحركات (َ، ِ، ُ) والتنوين (ً، ٍ، ٌ) بشكل صحيح نحويًا.

  ---

  ### 5. تنسيق الإجابة المطلوب (JSON)
  أجب **حصراً** بتنسيق JSON التالي دون أي نصوص إضافية خارجه:
  ```json
  {{
    "verses": [
      "البيت المصحح - الصدر",
      "البيت المصحح - العجز"
    ],
    "explanation": "شرح موجز لعملية إصلاح القافية، مع توضيح كيف تم تحقيق النمط المطلوب.",
    "original_qafiya": "القافية الأصلية",
    "new_qafiya": "القافية الجديدة",
    "changes_made": "التغييرات المطبقة، مثل: 'تم استبدال كلمة X بكلمة Y لتحقيق نمط القافية /o.'"
  }}

الآن، طبق منهجية إصلاح القافية المذكورة بدقة على البيت المحدد، وقدم إجابتك بالتنسيق المطلوب.:
category: generation
parameters:
  - meter
  - meeter_tafeelat
  - qafiya
  - qafiya_pattern
  - qafiya_type
  - qafiya_type_description_and_examples
  - theme
  - tone
  - existing_verses
  - context
metadata:
  version: "1.0"
  language: "arabic"
  complexity: "high"
  purpose: "qafiya_fix" 