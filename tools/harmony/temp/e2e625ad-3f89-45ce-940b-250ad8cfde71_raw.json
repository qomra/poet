{
  "execution_id": "e2e625ad-3f89-45ce-940b-250ad8cfde71",
  "started_at": "2025-08-10T16:30:43.803807",
  "user_prompt": "أريدك أن تكتب قصيدة عربية كلاسيكية تتناول موضوع الغزل وتعبر عن حزن الشاعر بسبب الفراق. يجب أن تتضمن القصيدة تصويرًا عاطفيًا للمحب الذي يعاني من ألم الفراق، مع التركيز على الدموع التي تتدفق من عينيه كرمز للحزن العميق. يجب أن يشعر القارئ بأن الشاعر يعاني وكأن كل جزء من جسده يحمل قلبًا نابضًا بسبب شدة الحزن. استخدم أسلوبًا شعريًا يجمع بين الصور القوية والعواطف الجياشة، مع الحفاظ على نبرة حزينة وعاطفية. يجب أن تكون القصيدة مكونة من 2 أبيات على بحر الكامل، مع استخدام قافية القاف في نهاية كل بيت.",
  "initial_constraints": {
    "meter": "بحر الكامل",
    "qafiya": "ق",
    "theme": "غزل",
    "tone": "حزينة"
  },
  "calls": [
    {
      "call_id": "b421fd2c-7603-43a3-b279-b66697b2e562",
      "timestamp": "2025-08-10T16:30:43.969950",
      "component_name": "QafiyaSelector",
      "method_name": "select_qafiya",
      "call_type": "process",
      "inputs": {
        "arg_0": {
          "meter": "بحر الكامل",
          "qafiya": "ق",
          "qafiya_harakah": null,
          "qafiya_type": null,
          "qafiya_pattern": null,
          "line_count": null,
          "theme": "غزل",
          "tone": "حزينة",
          "imagery": [],
          "keywords": [],
          "sections": [],
          "register": null,
          "era": null,
          "poet_style": null,
          "ambiguities": []
        },
        "arg_1": "أريدك أن تكتب قصيدة عربية كلاسيكية تتناول موضوع الغزل وتعبر عن حزن الشاعر بسبب الفراق. يجب أن تتضمن القصيدة تصويرًا عاطفيًا للمحب الذي يعاني من ألم الفراق، مع التركيز على الدموع التي تتدفق من عينيه كرمز للحزن العميق. يجب أن يشعر القارئ بأن الشاعر يعاني وكأن كل جزء من جسده يحمل قلبًا نابضًا بسبب شدة الحزن. استخدم أسلوبًا شعريًا يجمع بين الصور القوية والعواطف الجياشة، مع الحفاظ على نبرة حزينة وعاطفية. يجب أن تكون القصيدة مكونة من 2 أبيات على بحر الكامل، مع استخدام قافية القاف في نهاية كل بيت."
      },
      "outputs": {
        "meter": "بحر الكامل",
        "qafiya": "ق",
        "qafiya_harakah": "مكسور",
        "qafiya_type": "متواتر",
        "qafiya_pattern": "قِ",
        "line_count": null,
        "theme": "غزل",
        "tone": "حزينة",
        "imagery": [],
        "keywords": [],
        "sections": [],
        "register": null,
        "era": null,
        "poet_style": null,
        "ambiguities": []
      },
      "error": null,
      "llm_provider": null,
      "model_name": null,
      "prompt": null,
      "response": null,
      "tokens_used": null,
      "duration_ms": 4610,
      "success": true
    },
    {
      "call_id": "a3521fae-f6a6-42ad-a1d8-347f60a5d876",
      "timestamp": "2025-08-10T16:30:48.580348",
      "component_name": "RefinerChain",
      "method_name": "refine",
      "call_type": "refine",
      "inputs": {
        "target_quality": 1.0,
        "arg_0": {
          "verses": [
            "تَبْكي السَّحابُ عَلَى فِراقِكَ يا شَفَقْ",
            "وَالْقَلْبُ يَشْكُو مَا أَصابَهُ مِنْ حُرَقْ",
            "فِي لَيْلَةٍ حَزِنَتْ عَلَيْكَ دُجَى السُّهَا",
            "وَجْدِي عَلَيْكَ يَزِيدُ مَعْ نَفْحِ العَبَقْ"
          ],
          "llm_provider": "test",
          "model_name": "hardcoded",
          "constraints": {
            "meter": "بحر الكامل",
            "qafiya": "ق",
            "qafiya_harakah": null,
            "qafiya_type": null,
            "qafiya_pattern": null,
            "line_count": null,
            "theme": "غزل",
            "tone": "حزينة",
            "imagery": [],
            "keywords": [],
            "sections": [],
            "register": null,
            "era": null,
            "poet_style": null,
            "ambiguities": []
          },
          "generation_timestamp": "2025-08-10T16:30:48.580076",
          "quality": null
        },
        "arg_1": {
          "meter": "بحر الكامل",
          "qafiya": "ق",
          "qafiya_harakah": "مكسور",
          "qafiya_type": "متواتر",
          "qafiya_pattern": "قِ",
          "line_count": null,
          "theme": "غزل",
          "tone": "حزينة",
          "imagery": [],
          "keywords": [],
          "sections": [],
          "register": null,
          "era": null,
          "poet_style": null,
          "ambiguities": []
        }
      },
      "outputs": [
        {
          "verses": [
            "تَبْكي السَّحابُ عَلَى فِراقِكَ يا شَفَقْ",
            "وَالْقَلْبُ يَشْكُو مَا أَصابَهُ مِنْ عَشِقْ",
            "فِي لَيْلَةٍ حَزِنَتْ عَلَيْكَ دُجَى السُّهَا",
            "وَجْدِي عَلَيْكَ يَزِيدُ مِنْ قَلْبٍ شَفِقْ"
          ],
          "llm_provider": "test",
          "model_name": "hardcoded",
          "constraints": {
            "meter": "بحر الكامل",
            "qafiya": "ق",
            "qafiya_harakah": null,
            "qafiya_type": null,
            "qafiya_pattern": null,
            "line_count": null,
            "theme": "غزل",
            "tone": "حزينة",
            "imagery": [],
            "keywords": [],
            "sections": [],
            "register": null,
            "era": null,
            "poet_style": null,
            "ambiguities": []
          },
          "generation_timestamp": "2025-08-10T16:30:48.580076",
          "quality": {
            "prosody_issues": [
              "التفعيلة الثالثة في كل من الصدر والعجز جاءت على وزن (مفعولنْ) بدلاً من (متفاعلنْ) أو إحدى زحافاتها المسموحة. هذا التغيير غير مقبول في بحر الكامل حسب الزحافات المحددة"
            ],
            "line_count_issues": [],
            "qafiya_issues": [
              "العجز ينتهي بـ 'قْ' (قاف ساكن) بدلاً من 'قِ' (قاف مكسور) المطلوب، ولا يتبع نمط القافية المتواتر",
              "العجز ينتهي بقاف ساكن (شَفِقْ) بينما القافية المطلوبة تتطلب قاف مكسور (قِ)"
            ],
            "tashkeel_issues": [],
            "overall_score": 0.7,
            "is_acceptable": true,
            "recommendations": [
              "راجع الأوزان العروضية للأبيات",
              "راجع القافية في الأبيات"
            ],
            "prosody_validation": {
              "overall_valid": false,
              "total_baits": 2,
              "valid_baits": 1,
              "invalid_baits": 1,
              "bait_results": [
                {
                  "bait_text": "تَبْكي السَّحابُ عَلَى فِراقِكَ يا شَفَقْ#وَالْقَلْبُ يَشْكُو مَا أَصابَهُ مِنْ عَشِقْ",
                  "is_valid": true,
                  "pattern": "متفاعلنْ متفاعلنْ متفاعلنْ#متفاعلنْ متفاعلنْ متفاعلنْ",
                  "error_details": null,
                  "diacritized_text": "تَبْكي السَّحابُ عَلَى فِراقِكَ يا شَفَقْ#وَالْقَلْبُ يَشْكُو مَا أَصابَهُ مِنْ عَشِقْ"
                },
                {
                  "bait_text": "فِي لَيْلَةٍ حَزِنَتْ عَلَيْكَ دُجَى السُّهَا#وَجْدِي عَلَيْكَ يَزِيدُ مِنْ قَلْبٍ شَفِقْ",
                  "is_valid": false,
                  "pattern": "متفاعلنْ متفاعلنْ مفعولنْ#متفاعلنْ متفاعلنْ مفعولنْ",
                  "error_details": "التفعيلة الثالثة في كل من الصدر والعجز جاءت على وزن (مفعولنْ) بدلاً من (متفاعلنْ) أو إحدى زحافاتها المسموحة. هذا التغيير غير مقبول في بحر الكامل حسب الزحافات المحددة",
                  "diacritized_text": "فِي لَيْلَةٍ حَزِنَتْ عَلَيْكَ دُجَى السُّهَا#وَجْدِي عَلَيْكَ يَزِيدُ مِنْ قَلْبٍ شَفِقْ"
                }
              ],
              "bahr_used": "بحر الكامل",
              "validation_summary": "1 من 2 أبيات صحيحة عروضياً على بحر بحر الكامل. الأبيات الخاطئة: 2",
              "diacritics_applied": true
            },
            "qafiya_validation": {
              "overall_valid": false,
              "total_baits": 2,
              "valid_baits": 0,
              "invalid_baits": 2,
              "bait_results": [
                {
                  "bait_number": 1,
                  "is_valid": false,
                  "error_details": "العجز ينتهي بـ 'قْ' (قاف ساكن) بدلاً من 'قِ' (قاف مكسور) المطلوب، ولا يتبع نمط القافية المتواتر"
                },
                {
                  "bait_number": 2,
                  "is_valid": false,
                  "error_details": "العجز ينتهي بقاف ساكن (شَفِقْ) بينما القافية المطلوبة تتطلب قاف مكسور (قِ)"
                }
              ],
              "validation_summary": "جميع الأبيات (2) خاطئة قافياً على القافية المطلوبة (ق)",
              "misaligned_bait_numbers": [
                1,
                2
              ],
              "expected_qafiya": "ق",
              "qafiya_harakah": "مكسور",
              "qafiya_type": "متواتر",
              "qafiya_pattern": "قِ",
              "issues": [
                "العجز ينتهي بـ 'قْ' (قاف ساكن) بدلاً من 'قِ' (قاف مكسور) المطلوب، ولا يتبع نمط القافية المتواتر",
                "العجز ينتهي بقاف ساكن (شَفِقْ) بينما القافية المطلوبة تتطلب قاف مكسور (قِ)"
              ]
            },
            "line_count_validation": null,
            "tashkeel_validation": null
          }
        },
        [
          {
            "refiner_name": "qafiya_refiner",
            "iteration": 0,
            "before": {
              "verses": [
                "تَبْكي السَّحابُ عَلَى فِراقِكَ يا شَفَقْ",
                "وَالْقَلْبُ يَشْكُو مَا أَصابَهُ مِنْ حُرَقْ",
                "فِي لَيْلَةٍ حَزِنَتْ عَلَيْكَ دُجَى السُّهَا",
                "وَجْدِي عَلَيْكَ يَزِيدُ مَعْ نَفْحِ العَبَقْ"
              ],
              "llm_provider": "test",
              "model_name": "hardcoded",
              "constraints": {
                "meter": "بحر الكامل",
                "qafiya": "ق",
                "qafiya_harakah": null,
                "qafiya_type": null,
                "qafiya_pattern": null,
                "line_count": null,
                "theme": "غزل",
                "tone": "حزينة",
                "imagery": [],
                "keywords": [],
                "sections": [],
                "register": null,
                "era": null,
                "poet_style": null,
                "ambiguities": []
              },
              "generation_timestamp": "2025-08-10T16:30:48.580076",
              "quality": {
                "prosody_issues": [],
                "line_count_issues": [],
                "qafiya_issues": [
                  "العجز ينتهي بـ 'حُرَقْ' (القاف ساكن) بدلاً من القافية المطلوبة 'قِ' (القاف مكسور)، والنمط لا يتطابق مع المتواتر المطلوب",
                  "العجز ينتهي بـ 'قْ' (قاف ساكن) بدلاً من 'قِ' (قاف مكسور) كما هو مطلوب في نمط القافية"
                ],
                "tashkeel_issues": [],
                "overall_score": 0.8,
                "is_acceptable": true,
                "recommendations": [
                  "راجع القافية في الأبيات"
                ],
                "prosody_validation": {
                  "overall_valid": true,
                  "total_baits": 2,
                  "valid_baits": 2,
                  "invalid_baits": 0,
                  "bait_results": [
                    {
                      "bait_text": "تَبْكي السَّحابُ عَلَى فِراقِكَ يا شَفَقْ#وَالْقَلْبُ يَشْكُو مَا أَصابَهُ مِنْ حُرَقْ",
                      "is_valid": true,
                      "pattern": "متفاعلنْ متفاعلنْ متفاعلنْ#متفاعلنْ متفاعلنْ متفاعلنْ",
                      "error_details": null,
                      "diacritized_text": "تَبْكي السَّحابُ عَلَى فِراقِكَ يا شَفَقْ#وَالْقَلْبُ يَشْكُو مَا أَصابَهُ مِنْ حُرَقْ"
                    },
                    {
                      "bait_text": "فِي لَيْلَةٍ حَزِنَتْ عَلَيْكَ دُجَى السُّهَا#وَجْدِي عَلَيْكَ يَزِيدُ مَعْ نَفْحِ العَبَقْ",
                      "is_valid": true,
                      "pattern": "متفاعلنْ متفاعلنْ متفاعلنْ#متفاعلنْ متفاعلنْ متفاعلنْ",
                      "error_details": null,
                      "diacritized_text": "فِي لَيْلَةٍ حَزِنَتْ عَلَيْكَ دُجَى السُّهَا#وَجْدِي عَلَيْكَ يَزِيدُ مَعْ نَفْحِ العَبَقْ"
                    }
                  ],
                  "bahr_used": "بحر الكامل",
                  "validation_summary": "جميع الأبيات (2) صحيحة عروضياً على بحر بحر الكامل",
                  "diacritics_applied": true
                },
                "qafiya_validation": {
                  "overall_valid": false,
                  "total_baits": 2,
                  "valid_baits": 0,
                  "invalid_baits": 2,
                  "bait_results": [
                    {
                      "bait_number": 1,
                      "is_valid": false,
                      "error_details": "العجز ينتهي بـ 'حُرَقْ' (القاف ساكن) بدلاً من القافية المطلوبة 'قِ' (القاف مكسور)، والنمط لا يتطابق مع المتواتر المطلوب"
                    },
                    {
                      "bait_number": 2,
                      "is_valid": false,
                      "error_details": "العجز ينتهي بـ 'قْ' (قاف ساكن) بدلاً من 'قِ' (قاف مكسور) كما هو مطلوب في نمط القافية"
                    }
                  ],
                  "validation_summary": "جميع الأبيات (2) خاطئة قافياً على القافية المطلوبة (ق)",
                  "misaligned_bait_numbers": [
                    1,
                    2
                  ],
                  "expected_qafiya": "ق",
                  "qafiya_harakah": "مكسور",
                  "qafiya_type": "متواتر",
                  "qafiya_pattern": "قِ",
                  "issues": [
                    "العجز ينتهي بـ 'حُرَقْ' (القاف ساكن) بدلاً من القافية المطلوبة 'قِ' (القاف مكسور)، والنمط لا يتطابق مع المتواتر المطلوب",
                    "العجز ينتهي بـ 'قْ' (قاف ساكن) بدلاً من 'قِ' (قاف مكسور) كما هو مطلوب في نمط القافية"
                  ]
                },
                "line_count_validation": null,
                "tashkeel_validation": null
              }
            },
            "after": {
              "verses": [
                "تَبْكي السَّحابُ عَلَى فِراقِكَ يا شَفَقْ",
                "وَالْقَلْبُ يَشْكُو مَا أَصابَهُ مِنْ عَشِقْ",
                "فِي لَيْلَةٍ حَزِنَتْ عَلَيْكَ دُجَى السُّهَا",
                "وَجْدِي عَلَيْكَ يَزِيدُ مِنْ قَلْبٍ شَفِقْ"
              ],
              "llm_provider": "test",
              "model_name": "hardcoded",
              "constraints": {
                "meter": "بحر الكامل",
                "qafiya": "ق",
                "qafiya_harakah": null,
                "qafiya_type": null,
                "qafiya_pattern": null,
                "line_count": null,
                "theme": "غزل",
                "tone": "حزينة",
                "imagery": [],
                "keywords": [],
                "sections": [],
                "register": null,
                "era": null,
                "poet_style": null,
                "ambiguities": []
              },
              "generation_timestamp": "2025-08-10T16:30:48.580076",
              "quality": {
                "prosody_issues": [
                  "التفعيلة الثالثة في كل من الصدر والعجز جاءت على وزن (مفعولنْ) بدلاً من (متفاعلنْ) أو إحدى زحافاتها المسموحة. هذا التغيير غير مقبول في بحر الكامل حسب الزحافات المحددة"
                ],
                "line_count_issues": [],
                "qafiya_issues": [
                  "العجز ينتهي بـ 'قْ' (قاف ساكن) بدلاً من 'قِ' (قاف مكسور) المطلوب، ولا يتبع نمط القافية المتواتر",
                  "العجز ينتهي بقاف ساكن (شَفِقْ) بينما القافية المطلوبة تتطلب قاف مكسور (قِ)"
                ],
                "tashkeel_issues": [],
                "overall_score": 0.7,
                "is_acceptable": true,
                "recommendations": [
                  "راجع الأوزان العروضية للأبيات",
                  "راجع القافية في الأبيات"
                ],
                "prosody_validation": {
                  "overall_valid": false,
                  "total_baits": 2,
                  "valid_baits": 1,
                  "invalid_baits": 1,
                  "bait_results": [
                    {
                      "bait_text": "تَبْكي السَّحابُ عَلَى فِراقِكَ يا شَفَقْ#وَالْقَلْبُ يَشْكُو مَا أَصابَهُ مِنْ عَشِقْ",
                      "is_valid": true,
                      "pattern": "متفاعلنْ متفاعلنْ متفاعلنْ#متفاعلنْ متفاعلنْ متفاعلنْ",
                      "error_details": null,
                      "diacritized_text": "تَبْكي السَّحابُ عَلَى فِراقِكَ يا شَفَقْ#وَالْقَلْبُ يَشْكُو مَا أَصابَهُ مِنْ عَشِقْ"
                    },
                    {
                      "bait_text": "فِي لَيْلَةٍ حَزِنَتْ عَلَيْكَ دُجَى السُّهَا#وَجْدِي عَلَيْكَ يَزِيدُ مِنْ قَلْبٍ شَفِقْ",
                      "is_valid": false,
                      "pattern": "متفاعلنْ متفاعلنْ مفعولنْ#متفاعلنْ متفاعلنْ مفعولنْ",
                      "error_details": "التفعيلة الثالثة في كل من الصدر والعجز جاءت على وزن (مفعولنْ) بدلاً من (متفاعلنْ) أو إحدى زحافاتها المسموحة. هذا التغيير غير مقبول في بحر الكامل حسب الزحافات المحددة",
                      "diacritized_text": "فِي لَيْلَةٍ حَزِنَتْ عَلَيْكَ دُجَى السُّهَا#وَجْدِي عَلَيْكَ يَزِيدُ مِنْ قَلْبٍ شَفِقْ"
                    }
                  ],
                  "bahr_used": "بحر الكامل",
                  "validation_summary": "1 من 2 أبيات صحيحة عروضياً على بحر بحر الكامل. الأبيات الخاطئة: 2",
                  "diacritics_applied": true
                },
                "qafiya_validation": {
                  "overall_valid": false,
                  "total_baits": 2,
                  "valid_baits": 0,
                  "invalid_baits": 2,
                  "bait_results": [
                    {
                      "bait_number": 1,
                      "is_valid": false,
                      "error_details": "العجز ينتهي بـ 'قْ' (قاف ساكن) بدلاً من 'قِ' (قاف مكسور) المطلوب، ولا يتبع نمط القافية المتواتر"
                    },
                    {
                      "bait_number": 2,
                      "is_valid": false,
                      "error_details": "العجز ينتهي بقاف ساكن (شَفِقْ) بينما القافية المطلوبة تتطلب قاف مكسور (قِ)"
                    }
                  ],
                  "validation_summary": "جميع الأبيات (2) خاطئة قافياً على القافية المطلوبة (ق)",
                  "misaligned_bait_numbers": [
                    1,
                    2
                  ],
                  "expected_qafiya": "ق",
                  "qafiya_harakah": "مكسور",
                  "qafiya_type": "متواتر",
                  "qafiya_pattern": "قِ",
                  "issues": [
                    "العجز ينتهي بـ 'قْ' (قاف ساكن) بدلاً من 'قِ' (قاف مكسور) المطلوب، ولا يتبع نمط القافية المتواتر",
                    "العجز ينتهي بقاف ساكن (شَفِقْ) بينما القافية المطلوبة تتطلب قاف مكسور (قِ)"
                  ]
                },
                "line_count_validation": null,
                "tashkeel_validation": null
              }
            },
            "quality_before": 0.8,
            "quality_after": 0.7,
            "details": "Applied qafiya_refiner to fix issues"
          }
        ]
      ],
      "error": null,
      "llm_provider": null,
      "model_name": null,
      "prompt": null,
      "response": null,
      "tokens_used": null,
      "duration_ms": 46735,
      "success": true
    },
    {
      "call_id": "2e1be242-6c16-41de-89e0-1a85afc8b28c",
      "timestamp": "2025-08-10T16:31:35.316582",
      "component_name": "PoemEvaluator",
      "method_name": "evaluate_poem",
      "call_type": "evaluate",
      "inputs": {
        "arg_0": {
          "verses": [
            "تَبْكي السَّحابُ عَلَى فِراقِكَ يا شَفَقْ",
            "وَالْقَلْبُ يَشْكُو مَا أَصابَهُ مِنْ عَشِقْ",
            "فِي لَيْلَةٍ حَزِنَتْ عَلَيْكَ دُجَى السُّهَا",
            "وَجْدِي عَلَيْكَ يَزِيدُ مِنْ قَلْبٍ شَفِقْ"
          ],
          "llm_provider": "test",
          "model_name": "hardcoded",
          "constraints": {
            "meter": "بحر الكامل",
            "qafiya": "ق",
            "qafiya_harakah": null,
            "qafiya_type": null,
            "qafiya_pattern": null,
            "line_count": null,
            "theme": "غزل",
            "tone": "حزينة",
            "imagery": [],
            "keywords": [],
            "sections": [],
            "register": null,
            "era": null,
            "poet_style": null,
            "ambiguities": []
          },
          "generation_timestamp": "2025-08-10T16:30:48.580076",
          "quality": {
            "prosody_issues": [
              "التفعيلة الثالثة في كلا الشطرين جاءت على وزن (مَفْعُولُنْ) بدلاً من (مُتَفَاعِلُنْ) أو أحد زحافاتها المسموحة. هذا التغيير غير مسموح في بحر الكامل"
            ],
            "line_count_issues": [],
            "qafiya_issues": [
              "العجز ينتهي بقاف ساكن (عَشِقْ) بينما القافية المطلوبة هي قاف مكسور (قِ)",
              "البيت ينتهي بقاف ساكن (قْ) وليس قاف مكسور (قِ) كما هو مطلوب، والنمط الفعلي لا يطابق النمط المتواتر المطلوب"
            ],
            "tashkeel_issues": [],
            "overall_score": 0.7,
            "is_acceptable": true,
            "recommendations": [
              "راجع الأوزان العروضية للأبيات",
              "راجع القافية في الأبيات"
            ],
            "prosody_validation": {
              "overall_valid": false,
              "total_baits": 2,
              "valid_baits": 1,
              "invalid_baits": 1,
              "bait_results": [
                {
                  "bait_text": "تَبْكي السَّحابُ عَلَى فِراقِكَ يا شَفَقْ#وَالْقَلْبُ يَشْكُو مَا أَصابَهُ مِنْ عَشِقْ",
                  "is_valid": true,
                  "pattern": "متفاعلنْ متفاعلنْ متفاعلنْ#متفاعلنْ متفاعلنْ متفاعلنْ",
                  "error_details": null,
                  "diacritized_text": "تَبْكي السَّحابُ عَلَى فِراقِكَ يا شَفَقْ#وَالْقَلْبُ يَشْكُو مَا أَصابَهُ مِنْ عَشِقْ"
                },
                {
                  "bait_text": "فِي لَيْلَةٍ حَزِنَتْ عَلَيْكَ دُجَى السُّهَا#وَجْدِي عَلَيْكَ يَزِيدُ مِنْ قَلْبٍ شَفِقْ",
                  "is_valid": false,
                  "pattern": "مُتَفَاعِلُنْ مُتَفَاعِلُنْ مَفْعُولُنْ#مُتَفَاعِلُنْ مُتَفَاعِلُنْ مَفْعُولُنْ",
                  "error_details": "التفعيلة الثالثة في كلا الشطرين جاءت على وزن (مَفْعُولُنْ) بدلاً من (مُتَفَاعِلُنْ) أو أحد زحافاتها المسموحة. هذا التغيير غير مسموح في بحر الكامل",
                  "diacritized_text": "فِي لَيْلَةٍ حَزِنَتْ عَلَيْكَ دُجَى السُّهَا#وَجْدِي عَلَيْكَ يَزِيدُ مِنْ قَلْبٍ شَفِقْ"
                }
              ],
              "bahr_used": "بحر الكامل",
              "validation_summary": "1 من 2 أبيات صحيحة عروضياً على بحر بحر الكامل. الأبيات الخاطئة: 2",
              "diacritics_applied": true
            },
            "qafiya_validation": {
              "overall_valid": false,
              "total_baits": 2,
              "valid_baits": 0,
              "invalid_baits": 2,
              "bait_results": [
                {
                  "bait_number": 1,
                  "is_valid": false,
                  "error_details": "العجز ينتهي بقاف ساكن (عَشِقْ) بينما القافية المطلوبة هي قاف مكسور (قِ)"
                },
                {
                  "bait_number": 2,
                  "is_valid": false,
                  "error_details": "البيت ينتهي بقاف ساكن (قْ) وليس قاف مكسور (قِ) كما هو مطلوب، والنمط الفعلي لا يطابق النمط المتواتر المطلوب"
                }
              ],
              "validation_summary": "جميع الأبيات (2) خاطئة قافياً على القافية المطلوبة (ق)",
              "misaligned_bait_numbers": [
                1,
                2
              ],
              "expected_qafiya": "ق",
              "qafiya_harakah": "مكسور",
              "qafiya_type": "متواتر",
              "qafiya_pattern": "قِ",
              "issues": [
                "العجز ينتهي بقاف ساكن (عَشِقْ) بينما القافية المطلوبة هي قاف مكسور (قِ)",
                "البيت ينتهي بقاف ساكن (قْ) وليس قاف مكسور (قِ) كما هو مطلوب، والنمط الفعلي لا يطابق النمط المتواتر المطلوب"
              ]
            },
            "line_count_validation": null,
            "tashkeel_validation": null
          }
        },
        "arg_1": {
          "meter": "بحر الكامل",
          "qafiya": "ق",
          "qafiya_harakah": "مكسور",
          "qafiya_type": "متواتر",
          "qafiya_pattern": "قِ",
          "line_count": null,
          "theme": "غزل",
          "tone": "حزينة",
          "imagery": [],
          "keywords": [],
          "sections": [],
          "register": null,
          "era": null,
          "poet_style": null,
          "ambiguities": []
        },
        "arg_2": [
          {},
          {}
        ]
      },
      "outputs": {
        "verses": [
          "تَبْكي السَّحابُ عَلَى فِراقِكَ يا شَفَقْ",
          "وَالْقَلْبُ يَشْكُو مَا أَصابَهُ مِنْ عَشِقْ",
          "فِي لَيْلَةٍ حَزِنَتْ عَلَيْكَ دُجَى السُّهَا",
          "وَجْدِي عَلَيْكَ يَزِيدُ مِنْ قَلْبٍ شَفِقْ"
        ],
        "llm_provider": "test",
        "model_name": "hardcoded",
        "constraints": {
          "meter": "بحر الكامل",
          "qafiya": "ق",
          "qafiya_harakah": null,
          "qafiya_type": null,
          "qafiya_pattern": null,
          "line_count": null,
          "theme": "غزل",
          "tone": "حزينة",
          "imagery": [],
          "keywords": [],
          "sections": [],
          "register": null,
          "era": null,
          "poet_style": null,
          "ambiguities": []
        },
        "generation_timestamp": "2025-08-10T16:30:48.580076",
        "quality": {
          "prosody_issues": [
            "التفعيلة الثالثة في كل من الصدر والعجز جاءت على وزن (مفعولنْ) بدلاً من (متفاعلنْ) أو إحدى زحافاتها المسموحة. هذا التغيير غير مقبول في بحر الكامل حسب الزحافات المحددة"
          ],
          "line_count_issues": [],
          "qafiya_issues": [
            "العجز ينتهي بـ 'قْ' (قاف ساكن) بدلاً من 'قِ' (قاف مكسور) المطلوب، ولا يتبع نمط القافية المتواتر",
            "العجز ينتهي بقاف ساكن (شَفِقْ) بينما القافية المطلوبة تتطلب قاف مكسور (قِ)"
          ],
          "tashkeel_issues": [],
          "overall_score": 0.7,
          "is_acceptable": true,
          "recommendations": [
            "راجع الأوزان العروضية للأبيات",
            "راجع القافية في الأبيات"
          ],
          "prosody_validation": {
            "overall_valid": false,
            "total_baits": 2,
            "valid_baits": 1,
            "invalid_baits": 1,
            "bait_results": [
              {
                "bait_text": "تَبْكي السَّحابُ عَلَى فِراقِكَ يا شَفَقْ#وَالْقَلْبُ يَشْكُو مَا أَصابَهُ مِنْ عَشِقْ",
                "is_valid": true,
                "pattern": "متفاعلنْ متفاعلنْ متفاعلنْ#متفاعلنْ متفاعلنْ متفاعلنْ",
                "error_details": null,
                "diacritized_text": "تَبْكي السَّحابُ عَلَى فِراقِكَ يا شَفَقْ#وَالْقَلْبُ يَشْكُو مَا أَصابَهُ مِنْ عَشِقْ"
              },
              {
                "bait_text": "فِي لَيْلَةٍ حَزِنَتْ عَلَيْكَ دُجَى السُّهَا#وَجْدِي عَلَيْكَ يَزِيدُ مِنْ قَلْبٍ شَفِقْ",
                "is_valid": false,
                "pattern": "متفاعلنْ متفاعلنْ مفعولنْ#متفاعلنْ متفاعلنْ مفعولنْ",
                "error_details": "التفعيلة الثالثة في كل من الصدر والعجز جاءت على وزن (مفعولنْ) بدلاً من (متفاعلنْ) أو إحدى زحافاتها المسموحة. هذا التغيير غير مقبول في بحر الكامل حسب الزحافات المحددة",
                "diacritized_text": "فِي لَيْلَةٍ حَزِنَتْ عَلَيْكَ دُجَى السُّهَا#وَجْدِي عَلَيْكَ يَزِيدُ مِنْ قَلْبٍ شَفِقْ"
              }
            ],
            "bahr_used": "بحر الكامل",
            "validation_summary": "1 من 2 أبيات صحيحة عروضياً على بحر بحر الكامل. الأبيات الخاطئة: 2",
            "diacritics_applied": true
          },
          "qafiya_validation": {
            "overall_valid": false,
            "total_baits": 2,
            "valid_baits": 0,
            "invalid_baits": 2,
            "bait_results": [
              {
                "bait_number": 1,
                "is_valid": false,
                "error_details": "العجز ينتهي بـ 'قْ' (قاف ساكن) بدلاً من 'قِ' (قاف مكسور) المطلوب، ولا يتبع نمط القافية المتواتر"
              },
              {
                "bait_number": 2,
                "is_valid": false,
                "error_details": "العجز ينتهي بقاف ساكن (شَفِقْ) بينما القافية المطلوبة تتطلب قاف مكسور (قِ)"
              }
            ],
            "validation_summary": "جميع الأبيات (2) خاطئة قافياً على القافية المطلوبة (ق)",
            "misaligned_bait_numbers": [
              1,
              2
            ],
            "expected_qafiya": "ق",
            "qafiya_harakah": "مكسور",
            "qafiya_type": "متواتر",
            "qafiya_pattern": "قِ",
            "issues": [
              "العجز ينتهي بـ 'قْ' (قاف ساكن) بدلاً من 'قِ' (قاف مكسور) المطلوب، ولا يتبع نمط القافية المتواتر",
              "العجز ينتهي بقاف ساكن (شَفِقْ) بينما القافية المطلوبة تتطلب قاف مكسور (قِ)"
            ]
          },
          "line_count_validation": null,
          "tashkeel_validation": null
        }
      },
      "error": null,
      "llm_provider": null,
      "model_name": null,
      "prompt": null,
      "response": null,
      "tokens_used": null,
      "duration_ms": 18150,
      "success": true
    }
  ],
  "final_poem": null,
  "quality_assessment": null,
  "completed_at": null,
  "total_duration_ms": null,
  "total_llm_calls": 0,
  "total_tokens": 0
}